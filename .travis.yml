language: generic
sudo: required
services:
- docker

branches:
  only:
  - master

matrix:
  include:
  - name: PHP 7.3
    env: BUILD_ENV=php7.3
  - name: PHP 7.3 low deps
    env: BUILD_ENV=php7.3 DEPS=low
  - name: PHP 7.2
    env: BUILD_ENV=php7.2
  - name: PHP 7.2 low deps
    env: BUILD_ENV=php7.2 DEPS=low

cache:
  directories:
  - $HOME/.composer/cache

install:
- |
  if [[ ! $DEPS ]]; then
      make composer-install
  elif [[ $DEPS = 'dev' ]]; then
      make composer-install-dev
  elif [[ $DEPS = 'low' ]]; then
      make composer-install-lowest
  fi

script:
- make ci
